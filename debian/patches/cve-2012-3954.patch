--- isc-dhcp.orig/common/options.c	2012-09-14 00:10:33.637981795 -0400
+++ isc-dhcp/common/options.c	2012-09-14 00:10:47.085423586 -0400
@@ -2359,6 +2359,8 @@
 
 	/* And let go of our references. */
       cleanup:
+	if (lbp != NULL)
+		buffer_dereference(&lbp, MDL);
 	option_dereference(&option, MDL);
 
 	return 1;
Index: isc-dhcp/server/dhcpv6.c
===================================================================
--- isc-dhcp.orig/server/dhcpv6.c	2012-09-14 00:06:22.632378343 -0400
+++ isc-dhcp/server/dhcpv6.c	2012-09-14 00:10:47.089423421 -0400
@@ -1241,6 +1241,8 @@
 	struct data_string packet_oro;
 	isc_boolean_t no_resources_avail;
 
+	memset(&packet_oro, 0, sizeof(packet_oro));
+
 	/* Locate the client.  */
 	if (shared_network_from_packet6(&reply.shared,
 					packet) != ISC_R_SUCCESS)
@@ -1263,7 +1265,6 @@
 	 * Get the ORO from the packet, if any.
 	 */
 	oc = lookup_option(&dhcpv6_universe, packet->options, D6O_ORO);
-	memset(&packet_oro, 0, sizeof(packet_oro));
 	if (oc != NULL) {
 		if (!evaluate_option_cache(&packet_oro, packet, 
 					   NULL, NULL, 
@@ -1524,6 +1525,8 @@
 		packet_dereference(&reply.packet, MDL);
 	if (reply.client_id.data != NULL)
 		data_string_forget(&reply.client_id, MDL);
+	if (packet_oro.buffer != NULL)
+		data_string_forget(&packet_oro, MDL);
 	reply.renew = reply.rebind = reply.prefer = reply.valid = 0;
 	reply.cursor = 0;
 }
