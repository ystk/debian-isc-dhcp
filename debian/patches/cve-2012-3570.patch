--- isc-dhcp.orig/includes/dhcpd.h	2012-09-13 23:49:37.000000000 -0400
+++ isc-dhcp/includes/dhcpd.h	2012-09-14 00:05:57.097433510 -0400
@@ -432,11 +432,17 @@
 	isc_boolean_t unicast;
 };
 
-/* A network interface's MAC address. */
+/*
+ * A network interface's MAC address.
+ * 20 bytes for the hardware address
+ * and 1 byte for the type tag
+ */
+
+#define HARDWARE_ADDR_LEN 20
 
 struct hardware {
 	u_int8_t hlen;
-	u_int8_t hbuf [17];
+	u_int8_t hbuf [HARDWARE_ADDR_LEN + 1];
 };
 
 #if defined(LDAP_CONFIGURATION)
Index: isc-dhcp/server/dhcpv6.c
===================================================================
--- isc-dhcp.orig/server/dhcpv6.c	2012-09-13 23:25:40.000000000 -0400
+++ isc-dhcp/server/dhcpv6.c	2012-09-14 00:06:22.632378343 -0400
@@ -6029,7 +6029,7 @@
 		break;
 	}
 
-	if (hlen == 0)
+	if ((hlen == 0) || (hlen > HARDWARE_ADDR_LEN))
 		return 0;
 
 	/*
