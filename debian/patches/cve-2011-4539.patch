Description: Fix cve-2011-4539: error in regular expression handling
Origin: https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2011-4539
Bug-Debian: http://bugs.debian.org/652259

Index: isc-dhcp/common/tree.c
===================================================================
--- isc-dhcp.orig/common/tree.c	2012-04-28 15:01:08.000000000 -0400
+++ isc-dhcp/common/tree.c	2012-04-28 15:02:19.000000000 -0400
@@ -1120,6 +1120,7 @@
 		*result = 0;
 		memset(&re, 0, sizeof(re));
 		if (bleft && bright &&
+		    (left.data != NULL) && (right.data != NULL) &&
         	    (regcomp(&re, (char *)right.data, regflags) == 0) &&
 		    (regexec(&re, (char *)left.data, (size_t)0, NULL, 0) == 0))
 				*result = 1;
